
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 5 - Mode Choice &#8212; wsa October 2020 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Step 4 - Trip Generation" href="Step4.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Step4.html" title="Step 4 - Trip Generation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">wsa October 2020 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Step 5 - Mode Choice</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-wsa.mc"></span><div class="toctree-wrapper compound">
</div>
<div class="section" id="step-5-mode-choice">
<h1>Step 5 - Mode Choice<a class="headerlink" href="#step-5-mode-choice" title="Permalink to this headline">¶</a></h1>
<p>This script applies mode choice models to zone data, including accessibility
and demographic characteristics. The model series utilizes a consistent
structure, analyzing the following modal nests:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>non-motorized vs motorized</dt><dd><ul>
<li><p>(non-motorized) Walk vs. bike</p></li>
<li><dl class="simple">
<dt>(motorized) Auto vs transit</dt><dd><ul>
<li><p>(Auto) Driver vs. passenger</p></li>
<li><p>(Transit) Walk access vs. drive access</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>These models are applied separately for each travel purpose, and there
are separate models for trip productions and trip attractions. This means
there are 5 models applied to 4 purposes for both trip ends (5*4*2), making
40 model applications in all.</p>
<p>Additionally, models are applied at the block scale in the “window area” and
at the TAZ scale for the rest of the model area.</p>
<dl class="simple">
<dt>The application steps rely on two primary types of input:</dt><dd><ul class="simple">
<li><p>Accessibility scores (generated by mode and purpose) pulled from csv’s.</p></li>
<li><p>Demographic data (HH types) are pulled from the labeled arrays created
during the trip gen process that contain cross-classified households.</p></li>
</ul>
</dd>
<dt>A mode choice labeled array is generated with the following dimensions:</dt><dd><ul class="simple">
<li><p>Zones (TAZs or blocks depending on the scale of anlysis)</p></li>
<li><p>HH Size (“-“, “HHSize1”, “HHSize2”, “HHSize3”, “HHSize4p”)</p></li>
<li><p>Vehicle Ownership (“-“, “Veh0”, “Veh1”, “Veh2”, “Veh3p”)</p></li>
<li><p>Income (“-“, “Inc1”, “Inc2”, “Inc3”, “Inc4”)</p></li>
<li><p>Workers (“-“, “worker0”, “worker1”, “worker2”, “worker3p”)</p></li>
<li><p>Purpose (“-“, “HBW”, “HBSch”, “HBO”, “NHB”)</p></li>
<li><p>End (“P”, “A”)</p></li>
<li><p>Mode (“Walk”, “Bike”, “Drive”, “Passenger”, “Transit WAT”, “Transit DAT”)</p></li>
</ul>
</dd>
</dl>
<p>This means mode shares are estimated by zone, household type (“-” for most
attractions or NHB productions since these are non-home generators), purpose,
and trip end. These shares can then be applied to yet another labeled array:
trips-by-mode, which is the product of the mode choice and trip gen arrays.</p>
<p>Model application entails fetching appropriate sections of the demographic
array (HH by type); vectorizing, reindexing, and broadcasting accessibility
arrays; transforming values based on model coefficients as needed; and
adding model intercept constants.  All of this occurs in an in-memory array
dimensioned to match the targeted section of the on-disk mode choice array.
The accumulated values effectively apply a linear regression formula by adding
coefficient-adjusted factors together. The mode choice models are, however,
binomial logistic equations, and the linear results are used to determine
the probability of selecting each mode in the nest as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>choice1 = exp(linear_result)/(1 + exp(linear_result))</p></li>
<li><p>choice0 = 1 - choice1</p></li>
</ul>
</div></blockquote>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Step1.html">Step 1 - Clean Skims</a></li>
<li class="toctree-l1"><a class="reference internal" href="Step2.html">Step 2 - Import Skims</a></li>
<li class="toctree-l1"><a class="reference internal" href="Step3.html">Step 3 - Summarize Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="Step4.html">Step 4 - Trip Generation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Step 5 - Mode Choice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Step4.html"
                        title="previous chapter">Step 4 - Trip Generation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Step5.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Step4.html" title="Step 4 - Trip Generation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">wsa October 2020 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Step 5 - Mode Choice</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Alex Bell.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>